{% extends 'base.html' %}

{% block head %} 

{% endblock %}

{% block body %}
    {% if not error%}
    <!-- start of the sidebar -->
    <div class="container">
        <div class="sidebar">
            <div class="info"> 
                    <b> Staff Information: </b> </br>
                        Name: {{session["first_name"]}} {{session["last_name"]}} </br>
                    Company: {{session["airline_name"]}} </br>
                </div>
        </br>
            <a href = "/staffHome" class = "option"> Home </a>  
            <a href = "/flightManage" class = "option"> Flights Management </a> 
            <a href = "/airplaneManage" class = "option"> Airplanes Management</a>   
            <a href = "/airportManage" class = "option"> Airports Management</a> 
            <a href = "/ratings" class = "option"> View Ratings</a>
            <a href = "/topAgent" class = "option"> View Top Booking Agents</a>  
            <a href = "/topCustomer" class = "option"> View Top Customers</a> 
            <a href = "/report" class = "option"> View Reports </a> 
            <a href = "/revenueCompare" class = "option"> Revenue Comparison </a> 
            <a href = "/topDestination" class = "option"> Top Destination </a> 
            <input type="submit" value = Logout> <br>
        </div>
    <!-- sidebar ends -->

    <!-- display content -->
        <div class="content">
            <h1>Flights Operated by {{session["airline_name"]}} </h1>

            <div class = "condition panel">
                <form action='/flightManage' method="POST">
                    <h4> View Options </h4>
                    <input type="text" name = "dept_from" placeholder="place of departure" required/> </br>
                    <input type="text" name = "arr_at" placeholder="destination" required/></br>
                    <div class="prompt">start date (departure date)</div>
                    <input type="date" name = "start_date" placeholder="start date date" required/></br>
                    <div class="prompt">end date(departure date)</div>
                    <input type="date" name = "end_date" placeholder="end date" required/></br>
                    <input type="submit" value = View> <br>   
                </form>
            </div>

            <div class = "flight_info">
                {% if flights %}  
                    {% if msg is string %}
                    <h4> {{msg}} </h4>
                    {% else %}
                    <h4> Departure From: {{msg[0]}}; Arrive at {{msg[1]}}; Start Date {{msg[2]}}; End Date {{msg[3]}} </h4>
                    {% endif %} 
                <table>
                        <th> Airline Name </th>
                        <th> Flight Number </th>
                        <th> Departure Time </th>
                        <th> Arrival Time </th>
                        <th> Base Price </th>
                        <th> Flight Status </th>
                        <th> Departure from </th>
                        <th> Arrive at </th>
                        <th> Airplane ID </th>
                        <th> Actions </th>
                    {% for line in flights %}
                        <tr>
                            <td>{{line['airline_name']}}</td>
                            <td>{{line['flight_num']}}</td>
                            <td>{{line['dept_time']}}</td>
                            <td>{{line['arr_time']}}</td>
                            <td>{{line['base_price']}}</td>
                            <td>{{line['flight_status']}}</td>
                            <td>{{line['dept_from']}}</td>
                            <td>{{line['arr_at']}}</td>
                            <td>{{line['airplane_id']}}</td>
                            <td>
                                <a href = "/updateFlight"> Update Status </a>
                                </br>
                                <a href = "/viewPassengers"> View Passengers </a>
                            </td>
                        </tr>
                    {% endfor %}
                {% endif %}
                </table>

                {% if noFound %}
                <p class="noFound"><strong>Error:</strong> {{noFound}}</p>
                <a href='/flightManage'>Go back to Flight Management</a>
                {% endif %}
            </div>
            
            <div class = "add_flights">
                <h4> Add New Flights </h4>
                <form action = "/addFlights" method = "POST"> 
                    <input type="text" name = "flight_num1" placeholder="flight number" required/> </br>
                    <div class="prompt">departure time </div>
                    <input type="datetime-local" name = "dept_time1" placeholder="departure time" required/></br>
                    <div class="prompt">arrival time </div>
                    <input type="datetime-local" name = "arr_time1" placeholder="arrival time" required/></br>
                    <input type="text" name = "base_price1" placeholder="Base Price" required/> </br>
                    <input type="text" name = "dept_from1" placeholder="place of departure" required/> </br>
                    <input type="text" name = "arr_at1" placeholder="destination" required/></br>
                    <input type="text" name = "airplane_id1" placeholder="airplane_id" required/></br>
                    <input type="submit" value = Add> <br>   
                </form>
            </div>
        </div>
    </div>
    {% endif %}



    {% if error %}
        <p class="error"><strong>Error:</strong> {{error}}</p>
        <a href='/login'>Go back to Login</a>
    {% endif %}

    <script src="{{ url_for('static',filename='js/script.js')}}"></script>
{% endblock %}